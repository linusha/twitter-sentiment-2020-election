---
title: "HICSS Modelling"
author: "Linus Hagemann"
date: "June 10, 2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(stargazer)
library(MASS)
library(stringr)
library(qdap)
library(DataExplorer)
library(sylcount)
library(here)
here()
load(here('final_data.RData'))
```

Overall size of our sample: `r nrow(tweet_data)` tweets.

We will work with the sentiment scores of the `clean_tweet`s I scraped. (*This is also the reason some variables are prefixed with `ct` or similar.*) The following preprocessing has occured on that:

- Beginning with the original tweet
- content of the tweet has been converted to lower case
- all urls, hashtags (#) and e-mail adresses has been removed
- the actual words of the hashtags have been preserved (e.g. *#Biden* now reads *biden*).

# Modelling

Here is a list of all features used in the following modelling:

|           Name          |                                         Description                                        |          Comment         |
|:-----------------------:|:------------------------------------------------------------------------------------------:|:------------------------:|
|        retweeted        |                                         TRUE/FALSE                                         |                          |
|         retweets        |                                     Number of Retweets                                     |                          |
|        repliedTo        |                                         TRUE/FALSE                                         |                          |
|         replies         |                                      Number of Replies                                     |                          |
|          liked          |                                         TRUE/FALSE                                         |                          |
|          likes          |                                       Number of Likes                                      |                          |
|       hashtagCount      |                                 Number of Hashtags in Tweet                                |                          |
|           url           |                                         TRUE/FALSE                                         |                          |
|            WC           |                       Length of tweet as it appeared online in words                       |           LIWC           |
|     sentiment           |                            0 - 8                                                           |      Stieglitz           |
|     polarity            |                            0 - 8                                                           |      Stieglitz           |
|            i            |                                                                                            |           LIWC           |
|            we           |                                                                                            |           LIWC           |
|           they          |                                                                                            |           LIWC           |
|          flesch         |                      calculated based on the output from LIWC/manually                     |                          |
|      user_activity      |          Amount of tweets user made in the timeframe in which we collected tweets          |  also done by Stieglitz  |
|         insight         |                                                                                            |           LIWC           |
|          cause          |                                                                                            |           LIWC           |
|         discrep         |                                                                                            |           LIWC           |
|         certain         |                                                                                            |           LIWC           |
|        fameLevel        | 0 - not on list, 1 - on list, 2 - on list over 100k follower, 3 - over 1kk, 5 - over 100kk |                          |

**The original positive and negative scores were ommited from the model due to them being redundant because of their high correlation with sentiment and polarity.**

## Modelling on all Tweets in the data set

### Modelling Binary Targets

Using logistic regression.

#### Commented

```{r}
stargazer(glm(repliedTo ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + fameLevel + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
    data = tweet_data,
    family = binomial(link = 'logit')), type = 'text')
```

#### Liked

```{r}
stargazer(glm(liked ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + fameLevel + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
    data = tweet_data,
    family = binomial(link = 'logit')), type = 'text')
```

#### Retweeted

```{r}
stargazer(glm(retweeted ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + fameLevel + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
    data = tweet_data,
    family = binomial(link = 'logit')), type = 'text')
```


## Modelling count on Tweets from not famous people

These only take into account tweets that were liked / replied / commented at least once.

### Likes

Tried similar models to the one below, unfortunately could not fit one that converged. Maybe since there is additional signal that we did not catch?
Liking something is the least effortful interaction possible on twitter. For a reply something needs to be written, retweets are a higher "commitment", since the retweet will be shown on the own timeline.

### Replies

```{r}
summary(glm.nb(replies ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
                data = not_famous_tweet_data[not_famous_tweet_data$replies > 0,]))
```

### Retweets

```{r}
summary(glm.nb(retweets ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
                data = not_famous_tweet_data[not_famous_tweet_data$retweets > 0,]))
```


## Modelling on the tweets of important people

People/Tweeters are deemed important or famous if they are on our list of media/celebrity/politicians accounts from socialbakers.
This subsample is smaller and only contains `r nrow(famous_tweet_data)` tweets. Negative Binomial models are considered not suitable for small data sets (although there does not seem to be an universal consensus what that means in raw numbers). I therefore opt try the same models as above here again and we'll see how we like it.


#### Comments

```{r}
summary(glm.nb(replies ~ hashtagCount + url + 
               cleanLIWC_WC + user_activity
                + fameLevel + flesch + #controls
                ct_polarity + ct_sentiment + # emotions
                cleanLIWC_i + cleanLIWC_we + cleanLIWC_they + #prosocial
                cleanLIWC_insight + cleanLIWC_cause + cleanLIWC_discrep + cleanLIWC_certain,
                data = famous_tweet_data))
```

#### Likes

I again could not manage to produce something that runs, maybe a similar issue to the one above. Sorry.

#### Retweets

Same here :/

